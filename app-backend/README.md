code is revised and fixed to work with each other
